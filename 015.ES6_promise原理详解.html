<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>

</body>
<script>
    //  1. 理解：
    //        promise 对象: 代表了未来某个将要发生的事件(通常是个异步操作)
    //        有了 promise 对象, 可以将异步操作以同步的流程表达出来, 避免了层层嵌套的回调函数(俗称回调地狱) 
    //        ES6 的 Promise 是一个构造函数, 用来生成 promise 实例
    //  2. 使用 promise 基本步骤 (2步):*
    //        创建 promise 对象
    //        let promise = new Promise((resolve, reject) => {
    //          // 初始化 promise 状态为 pending
    //          // 执行异步操作
    //          if (异步操作成功) {
    //              resolve(data) // 修改 promise 的状态为 fullfilled
    //          } else {
    //              reject(error) // 修改 promise 的状态为 rejected
    //          }
    //          })
    //          // 调用 promise 的 then()
    //          promise.then(
    //              (result) => {
    //                  console.log(result)
    //              },
    //              (errorMsg) => {
    //                  alert(errorMsg)
    //              }
    //          )
    // 3. promise 的三个状态
    //       pending 初始化状态
    //       fullfilled 成功状态
    //       rejected 失败状态
    // 4. 应用:
    //     使用 promise 实现超时处理
    //     使用 promise 封装处理 ajax 请求
    //       let request = new XMLHttpRequest()
    //       request.onreadystatechange = function() {}
    //       request.responseText = "json"
    //       request.open("GET", url)
    //       request.send()


    // 创建 promise 对象
    let promise = new Promise((resolve, reject) => { // 这个参数 为 同步的
        // 只要一 new 就进入 初始化 promise 状态:  pending 初始化
        console.log('111')
            // 执行异步操作, 通常发送 ajax 请求, 开启定时器
        setTimeout(() => {
            console.log('333')
                // 根据异步任务的返回结果, 来去修改 promise 的状态
                // 异步任务执行成功
                // resolve("hahah") // 修改 promise 的状态为 fullfilled: 成功状态
                //异步任务执行失败
            reject("不开心") // 修改 promise 的状态为 rejected: 失败状态
        }, 2000)
    })
    console.log('222')

    promise.then((data) => { // 成功的回调
        console.log('成功了' + data)
    }, (erro) => { // 失败的回调
        console.log('失败了' + erro)
    })

    // 原理: 通过执行异步任务的结果, 去修改 promise 的状态, 来调用他实例对象里面 then 的成功或者是失败的回调
</script>

</html>